@page "/datatablesTest"
@using BlazorServerTest.BLL.Services
@using BlazorServerTest.Data.Entities
@inject RecipeService RecipeService
@inject IJSRuntime JS

<DataTable>
	<thead>
	<tr>
        <th>@nameof(RecipeEntity.Id)</th>
        <th>@nameof(RecipeEntity.Name)</th>
        <th>@nameof(RecipeEntity.Description)</th>
        <th>@nameof(RecipeEntity.CookTime)</th>
        <th>@nameof(RecipeEntity.Servings)</th>
	</tr>
	</thead>
	<tbody>
	@foreach (var recipe in recipes)
	{
		<tr>
            <td>@recipe.Id</td>
            <td>@recipe.Name</td>
            <td>@recipe.Description</td>
            <td>@recipe.CookTime</td>
            <td>@recipe.Servings</td>
            <td><ConfirmModalComponent ButtonText="❌" Message="Do you rale want to delete?" Id="@recipe.Id" OnYes="@DeleteHandler" /></td>
		</tr>
	}
	</tbody>
</DataTable>

@code {
    private List<RecipeEntity> recipes;

    protected override async  Task OnInitializedAsync()
    {
        recipes = (await RecipeService.GetForecastAsync(String.Empty)).ToList();

    }

    private async Task DeleteHandler(int id)
    {
        await RecipeService.Delete(id);
        recipes = (await RecipeService.GetForecastAsync(String.Empty)).ToList();
        StateHasChanged();
    }
	/*
    public void Dispose()
    {
        JS.InvokeAsync<IJSObjectReference>("DataTablesRemove", "#example");
    }*/
}